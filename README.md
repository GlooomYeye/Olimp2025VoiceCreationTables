# Голосовой создатель таблиц

Это приложение позволяет создавать и заполнять таблицы с помощью голосовых команд на русском языке. Используется библиотека Vosk для распознавания речи.

## Требования

- Python 3.8 или выше
- Рабочий микрофон
- Зависимости:
  - vosk==0.3.44 (распознавание речи)
  - PyAudio==0.2.14 (работа с аудио)
  - tabulate==0.9.0 (форматирование таблиц)
  - natasha==1.6.0 (обработка текста)

## Установка

1. Клонируйте репозиторий или скачайте исходный код.

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Скачайте и распакуйте русскую модель Vosk (например, vosk-model-small-ru-0.22) в папку проекта.

## Использование

1. Запустите приложение:
```bash
python voice_table.py
```

2. Доступные голосовые команды:

- **Создание таблицы:**
  "создай таблицу турнир столбцы фамилия имя команда балл"
- **Переход к следующей строке:**
  "следующая строка"
- **Пауза заполнения:**
  "пауза" (для временной остановки работы)
- **Продолжить заполнение:**
  "продолжить" или "продолжай" (для выхода из паузы)
- **Редактирование ячейки:**
  "редактировать строка [номер] столбец [название]"
- **Отмена последнего действия:**
  "отмена"
- **Сохранение таблицы:**
  "сохрани"
- **Завершение работы:**
  "выход"

## Особенности работы

1. **Создание таблицы:**
   - После слова "таблицу" укажите название таблицы.
   - После слова "столбцы" перечислите названия столбцов.
   - Количество столбцов определяется автоматически.
   - Новые строки добавляются по мере заполнения данных.

2. **Заполнение данных:**
   - Просто произносите значения для текущей ячейки.
   - После каждого значения программа автоматически переходит к следующей ячейке.
   - При заполнении последней ячейки в строке автоматически создаётся новая строка.
   - Для перехода к следующей строке раньше используйте команду "следующая строка".
   - Для временной остановки заполнения используйте команду "пауза".
     Для продолжения скажите "продолжить" или "продолжай".
   - Для редактирования уже заполненной ячейки используйте команду "редактировать", указав номер строки и название столбца.
   - Для отмены последнего действия используйте команду "отмена".

3. **Числовые значения:**
    - Программа автоматически преобразует числовые выражения в числа с помощью библиотеки natasha.
    - Поддерживаются различные форматы чисел, включая:
      - Целые числа: "двадцать пять" → 25
      - Дробные числа: "два и пять десятых" → 2,5
      - Составные числа: "тысяча двести тридцать один" → 1231
    - Дробные числа записываются с запятой.

## Логирование

Приложение ведёт подробный лог всех действий в папке `logs`:
- Распознанные голосовые команды
- Создание и изменение таблицы
- Заполнение ячеек
- Переходы между строками
- Отмена действий
- Сохранение таблицы

Лог-файл создаётся с именем `logs/voice_table_YYYYMMDD_HHMMSS.log`.

## Пример использования

1. "создай таблицу турнир столбцы фамилия имя команда балл" — создаст таблицу "турнир" с 4 столбцами
2. "петров" — запишет фамилию
3. "иван" — запишет имя
4. "спартак" — запишет команду
5. "десять" — запишет балл и автоматически создаст новую строку
6. "двадцать пять" — запишет 25
7. "два целых пять десятых" — запишет 2,5
8. "три сотых" — запишет 0,03
9. "отмена" — вернёт таблицу к предыдущему состоянию
10. "редактировать строка 1 столбец имя" — переход к редактированию имени в первой строке
11. "василий" — изменит имя на "василий"
12. "сохрани" — сохранит таблицу в файл и позволит создать новую
13. "пауза" — временно приостанавливает заполнение таблицы
14. "продолжить" — возобновляет заполнение после паузы

Таблица автоматически сохраняется в файл с именем "[название_таблицы].csv" при использовании команды "сохрани".