# Голосовой создатель таблиц

Это приложение позволяет создавать и заполнять таблицы с помощью голосовых команд на русском языке. Используется библиотека Vosk для распознавания речи.

## Требования

- Python 3.8 или выше
- Рабочий микрофон
- Зависимости:
  - vosk==0.3.44 (распознавание речи)
  - PyAudio==0.2.14 (работа с аудио)
  - tabulate==0.9.0 (форматирование таблиц)
  - text2num==2.5.2 (преобразование текстовых чисел)

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone https://github.com/GlooomYeye/Olimp2025VoiceCreationTables.git
cd Olimp2025VoiceCreationTables
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Установите модель Vosk для русского языка:
   - Скачайте архив модели [vosk-model-small-ru-0.22](https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip)
   - Распакуйте архив в папку проекта, сохранив оригинальное название папки 'vosk-model-small-ru-0.22'
   
4. Убедитесь, что у вас подключен и работает микрофон

5. Запустите приложение:
```bash
python voice_table.py
```

После запуска программа будет ожидать голосовые команды. Начните с создания таблицы.

## Использование

### Основные команды

- **Создание таблицы:**
  - "создай таблицу [название] столбцы [названия столбцов]"
  - "создай таблицу шаблон [номер]" (доступные шаблоны: 1, 2, 3)

- **Управление строками:**
  - "следующая строка" - переход к следующей строке
  - "вставить строка [номер]" - вставка пустой строки перед указанной
  - "удалить строка [номер]" - удаление строки
  
- **Управление ячейками:**
  - "редактировать строка [номер] столбец [название]" - редактирование конкретной ячейки
  - "пропусти" - пропуск текущей ячейки (заполняется символом '_')
  - "вернуться" - возврат к предыдущей позиции

- **Управление процессом:**
  - "пауза" - временная остановка заполнения
  - "продолжить" или "продолжай" - выход из паузы
  - "отмена" - отмена последнего действия
  - "сохрани" - сохранение таблицы в CSV файл
  - "выход" - завершение работы
  - "помощь" - вывод списка команд

### Особенности работы

1. **Создание таблицы:**
   - После слова "таблицу" укажите название таблицы
   - После слова "столбцы" перечислите названия столбцов
   - Или используйте готовые шаблоны: "создай таблицу шаблон [1-3]"

2. **Заполнение данных:**
   - Произносите значения для текущей ячейки
   - Программа автоматически переходит к следующей ячейке
   - При заполнении последней ячейки автоматически создаётся новая строка
   - Используйте "следующая строка" для досрочного перехода
   - Используйте "пропусти" для пропуска ячейки
   - Используйте "вернуться" для возврата к предыдущей позиции

3. **Числовые значения:**
    - Программа автоматически преобразует числовые выражения в числа с помощью библиотеки text2num
    - Поддерживаются различные форматы чисел, включая:
      - Целые числа: "двадцать пять" → 25
      - Дробные числа: "два и пять десятых" → 2,5
      - Составные числа: "тысяча двести тридцать один" → 1231
    - Дробные числа записываются с запятой

## Логирование

Приложение ведёт подробный лог всех действий в папке `logs`:
- Распознанные голосовые команды
- Создание и изменение таблицы
- Заполнение ячеек
- Переходы между строками
- Отмена действий
- Сохранение таблицы

Лог-файл создаётся с именем `logs/voice_table_YYYYMMDD_HHMMSS.log`.

## Пример использования

1. "создай таблицу турнир столбцы фамилия имя команда балл" — создаст таблицу
2. "петров" — запишет фамилию
3. "иван" — запишет имя
4. "спартак" — запишет команду
5. "десять" — запишет балл и автоматически создаст новую строку
6. "вставь строка 1" — вставит пустую строку перед первой строкой
7. "удалить строка 2" — удалит вторую строку
8. "пропусти" — пропустит текущую ячейку
9. "вернуться" — вернётся к предыдущей позиции
10. "редактировать строка 1 столбец имя" — переход к редактированию
11. "василий" — изменит имя
12. "сохрани" — сохранит таблицу в CSV файл

Таблица автоматически сохраняется в файл с именем "[название_таблицы].csv" при использовании команды "сохрани".